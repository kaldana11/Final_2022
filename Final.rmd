---
title: "Covid91 vaccine study Final2023"
author: "Kimberly Aldana!"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="final.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

```{r}
FinalDat <- FinalData %>%
mutate(across(where(is.character), as.factor))
guy= filter(FinalData, sex =="M")
gal = filter(FinalData, sex =="F")
gay = filter(FinalData, LGBTQ =="gay")
DrugUser = filter(FinalData, DrugUser =="yes")

```


## Males

```{r}
dd2 <- guy %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

This graph shows guys(males) and if they got COVID or not due to receiving the covid vaccine or the placebo. We see that males did not get as infected whether they took the vaccine or placebo. But the second graph when it is just males, we see those who got the placebo about 70% got COVID.


## Males Numerical Results 

```{r}
table1 <- xtabs(~infected + treatment, data=guy)
rowPerc(table1)
colPerc(table1)
```

We see that 69.57% of males who took the placebo got covid19. Those who took the vaccine and were okay were about 49.52.When it is the 100% total and the males, we see only 2.55% got covid 19 with the placebo.

## Males Inferential Results

```{r}
chisq.test(table1)
chisqtestGC(table1)
guysfish <- fisher.test(table1)
guysfish
```

Our p value is 4.631e-14 and our odds ratio is 2.242522 for the count data.0.51% of men got the placebo and were okay. 


```{r}
effect <- guysfish$p.value/(guysfish$p.value +1)
effectivenessguy = guysfish$estimate/(guysfish$estimate +1)*100
print(effectivenessguy)
```

```{r}
low=(guysfish$conf.int[1]/(guysfish$conf.int[1] +1))*100
hi=(guysfish$conf.int[2]/(guysfish$conf.int[2] +1))*100
options(digits=2)
```

The hi value is around 73.76 and the low value is around 64.26. The effectiveness of the vaccine is 69.2 Which is above 50% and shows it is effective in protecting guys from getting covid19. 


## Females

```{r}
dd2 <- gal %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(dd2,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(dd2,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

We see that women who took the placebo and vaccine got a low percentage in contracting covid19.60% of gals who took the placebo got covid19. 50% of them were each okay depending if they took the placebo or vaccine. 

## Female Numerical Results



```{r}
table1 <- xtabs(~infected + treatment, data=gal)
rowPerc(table1)
colPerc(table1)
```

There was 40% of gals who took the vaccine and got covid19. 2% of gals who took the placebo got covid19. The total is 100.

## Female Inferential Results



```{r}
chisq.test(table1)
chisqtestGC(table1)
galsfish <- fisher.test(table1)
galsfish
```

In the chi test our p value is 3e-04. We know 213 females were given the placebo and got covid19. In the fishers test our p value is 2e-04 and the odd ratio is 1.5. The confidence interval is 1.2 1.9. 




## LGBTQ



## Druggies


# Overall Results and Conclusions